optimizer:
  _target_: torch.optim.AdamW
  lr: 0.001
  amsgrad: true
  weight_decay: 0.001
scheduler:
  _target_: torch.optim.lr_scheduler.StepLR
  step_size: 10
  gamma: 0.5
model:
  _target_: tr_learn.model.cls_model.PlateClassification
  is_full_train: false
  model_type: resnet18
datamodule:
  _target_: tr_learn.data.datamodule.PlateDataModuleTrainValid
  train_load_info:
    _target_: tr_learn.data.datamodule.LoadInfo
    is_jit_transform: true
    root: ./data/raw/plates
    batch_size: 8
    transform: ???
    num_workers: 4
  valid_load_info:
    _target_: tr_learn.data.datamodule.LoadInfo
    root: ./data/raw/plates
    is_jit_transform: true
    batch_size: 8
    transform: ???
    num_workers: 4
  predict_load_info:
    _target_: tr_learn.data.datamodule.LoadInfo
    root: ./data/raw/plates
    is_jit_transform: true
    batch_size: 8
    transform:
      _target_: torch.nn.Sequential
      _args_:
      - _target_: torchvision.transforms.Resize
        _convert_: partial
        antialias: true
        size:
        - 224
      - _target_: torchvision.transforms.CenterCrop
        size: 224
      - _target_: tr_learn.data.transforms.convert_dtype
      - _target_: torchvision.transforms.Normalize
        _convert_: partial
        mean:
        - 0.485
        - 0.456
        - 0.406
        std:
        - 0.229
        - 0.224
        - 0.225
    num_workers: 4
  train_size: 0.7
  split_random_seed: 834823
transforms:
  image_norm_mean:
  - 0.485
  - 0.456
  - 0.406
  image_norm_std:
  - 0.229
  - 0.224
  - 0.225
  train_transform:
    _target_: torch.nn.Sequential
    _args_:
    - _target_: torchvision.transforms.Resize
      _convert_: partial
      antialias: true
      size:
      - 224
    - _target_: torchvision.transforms.CenterCrop
      size: 224
    - _target_: tr_learn.data.transforms.convert_dtype
    - _target_: torchvision.transforms.Normalize
      _convert_: partial
      mean:
      - 0.485
      - 0.456
      - 0.406
      std:
      - 0.229
      - 0.224
      - 0.225
  valid_transform:
    _target_: torch.nn.Sequential
    _args_:
    - _target_: torchvision.transforms.Resize
      _convert_: partial
      antialias: true
      size:
      - 224
    - _target_: torchvision.transforms.CenterCrop
      size: 224
    - _target_: tr_learn.data.transforms.convert_dtype
    - _target_: torchvision.transforms.Normalize
      _convert_: partial
      mean:
      - 0.485
      - 0.456
      - 0.406
      std:
      - 0.229
      - 0.224
      - 0.225
logger:
  _target_: lightning.pytorch.loggers.TensorBoardLogger
  save_dir: ./exp/cls_training/logs
loss:
  _target_: torch.nn.BCEWithLogitsLoss
  reduction: none
exp_dir: ./exp/cls_training
seed: 172197
trainer:
  _target_: lightning.Trainer
  accelerator: gpu
  precision: '32'
  fast_dev_run: false
  max_epochs: 10
  check_val_every_n_epoch: 1
  log_every_n_steps: 10
  benchmark: true
  deterministic: false
  inference_mode: true
  logger:
  - _target_: lightning.pytorch.loggers.TensorBoardLogger
    save_dir: ./exp/cls_training/logs
  callbacks:
  - _target_: lightning.pytorch.callbacks.EarlyStopping
    monitor: Valid/accuracy
    min_delta: 0.001
    patience: 2
    mode: max
  - _target_: lightning.pytorch.callbacks.LearningRateMonitor
    logging_interval: epoch
  - _target_: lightning.pytorch.callbacks.ModelCheckpoint
    save_top_k: 2
    mode: max
    monitor: Valid/accuracy
    dirpath: ./exp/cls_training/checkpoints
    filename: '{epoch}-{Valid/accuracy:.3f}'
    save_last: false
    save_weights_only: true
    every_n_epochs: 1
